%rebase base.tmpl

<h2>Run nยบ{{run_id}}</h2>

<div>Testing {{info['metadata']['fqn']}}</div>
<ul>
<li>Users: {{info['metadata']['users']}}</li>
<li>Hits: {{info['metadata']['hits']}}</li>
<li>Duration: {{info['metadata']['duration']}}</li>
<li>Agents: {{info['metadata']['agents']}}</li>
</ul>

<div>
hits: <span id="hits">{{info['counts']['add_hit']}}</span>
</div>
<div>
successes: <span id="hits">{{info['counts'].get('addSuccess', 0)}}</span>
</div>
<div>
failures: <span id="hits">{{info['counts'].get('addFailure', 0)}}</span>
</div>
<div>
errors: <span id="hits">{{info['counts'].get('addError', 0)}}</span>
</div>

<script>
  $(document).ready(function() {
    console.log('starting');
    try {
		var socket = new WebSocket("ws://localhost:8080/run/{{run_id}}/websocket");

		socket.onopen = function(){
		console.log("Socket has been opened!");
		};

		socket.onmessage = function(msg) {
        var obj = JSON.parse(msg.data);
		$('#hits').text(obj.add_hit);
		};

		socket.onclose = function() {
		console.log("closing");
		};
	}
	catch(exception) {
      console.log(exception);
    }

  });
</script>
